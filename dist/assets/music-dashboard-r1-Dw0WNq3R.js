import{r as i,j as e,i as x,B as _,l as v,X as A,Y as m,m as h,n as y,q as F,s as X,t as Y,u as q,v as z,w as W,K as $,N as H,P as w,p as o}from"./vendor-DG7lD9Pa.js";const J=t=>parseFloat(t.Energy)>.8&&parseFloat(t.Loudness)>-8?"Rock/Metal":parseFloat(t.Danceability)>.7&&parseFloat(t.Energy)>.6?"Pop/Dance":parseFloat(t.Acousticness)>.7?"Acoustic/Folk":parseFloat(t.Instrumentalness)>.5?"Classical/Instrumental":parseFloat(t.Energy)<.4&&parseFloat(t.Valence)<.4?"Ambient/Chill":"Other",Z=()=>{const[t,D]=i.useState([]),[E,P]=i.useState([]),[k,I]=i.useState([]),[C,G]=i.useState([]),[S,T]=i.useState([]);i.useEffect(()=>{(async()=>{try{const r=await window.fs.readFile("241121-track_audio_features.csv",{encoding:"utf8"}),B=await window.fs.readFile("241121-user_saved_tracks.csv",{encoding:"utf8"}),p=w.parse(r,{header:!0,skipEmptyLines:!0}).data,f=w.parse(B,{header:!0,skipEmptyLines:!0}).data,j={};f.forEach(a=>{j[a["Track ID"]]={name:a.Name,artist:a.Artist,popularity:parseInt(a.Popularity)||0}});const g=p.map(a=>({...a,genre:J(a)})),b=o.groupBy(g,"genre"),K=Object.entries(b).map(([a,n])=>({genre:a,count:n.length,avgPopularity:o.meanBy(n,u=>{var l;return((l=j[u["Track ID"]])==null?void 0:l.popularity)||0})})),R=["Danceability","Energy","Valence","Acousticness","Instrumentalness"],N=["Danceability","Energy","Valence","Acousticness","Instrumentalness"],L=Object.entries(b).map(([a,n])=>{const u=N.reduce((l,c)=>({...l,[c]:o.meanBy(n,V=>parseFloat(V[c]))}),{});return N.reduce((l,c)=>({...l,[c]:u[c],genre:a}),{})}),Q=R.map(a=>({feature:a,average:o.meanBy(p,n=>parseFloat(n[a])),fullMark:1})),M=g.map(a=>({danceability:parseFloat(a.Danceability),energy:parseFloat(a.Energy),genre:a.genre})),O=o.chain(f).filter(a=>a.Popularity&&a.Popularity!=="").map(a=>({name:a.Name,artist:a.Artist,popularity:parseInt(a.Popularity)})).orderBy(["popularity"],["desc"]).take(10).value();D(p),I(K),G(L),P(O),T(M)}catch(r){console.error("Error fetching data:",r)}})()},[]);const d={"Rock/Metal":"#ff7f7f","Pop/Dance":"#7fbfff","Acoustic/Folk":"#7fff7f","Classical/Instrumental":"#ff7fff","Ambient/Chill":"#ffff7f",Other:"#7f7f7f"};return e.jsxs("div",{className:"p-4 space-y-8 bg-gray-50",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Music Library Analysis"}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"3D Audio Feature Explorer"}),e.jsx("div",{className:"h-[600px]"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Genre Distribution (Based on Audio Features)"}),e.jsx("div",{className:"h-80",children:e.jsx(x,{children:e.jsxs(_,{data:k,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"genre"}),e.jsx(m,{yAxisId:"left",orientation:"left",stroke:"#8884d8"}),e.jsx(m,{yAxisId:"right",orientation:"right",stroke:"#82ca9d"}),e.jsx(h,{}),e.jsx(y,{}),e.jsx(F,{yAxisId:"left",dataKey:"count",name:"Number of Tracks",fill:"#8884d8"}),e.jsx(F,{yAxisId:"right",dataKey:"avgPopularity",name:"Average Popularity",fill:"#82ca9d"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Audio Features by Genre"}),e.jsx("div",{className:"h-96",children:e.jsx(x,{children:e.jsxs(X,{data:[{feature:"Danceability"},{feature:"Energy"},{feature:"Valence"},{feature:"Acousticness"},{feature:"Instrumentalness"}],children:[e.jsx(Y,{}),e.jsx(q,{dataKey:"feature"}),e.jsx(z,{angle:30,domain:[0,1]}),C.map(s=>e.jsx(W,{name:s.genre,dataKey:s.genre.toLowerCase().replace(/[^a-z]/g,""),stroke:d[s.genre],fill:d[s.genre],fillOpacity:.3},s.genre)),e.jsx(h,{}),e.jsx(y,{})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Danceability vs Energy by Genre"}),e.jsx("div",{className:"h-96",children:e.jsx(x,{children:e.jsxs($,{children:[e.jsx(v,{}),e.jsx(A,{type:"number",dataKey:"danceability",name:"Danceability",domain:[0,1]}),e.jsx(m,{type:"number",dataKey:"energy",name:"Energy",domain:[0,1]}),e.jsx(h,{cursor:{strokeDasharray:"3 3"}}),e.jsx(y,{}),Object.keys(d).map(s=>e.jsx(H,{name:s,data:S.filter(r=>r.genre===s),fill:d[s]},s))]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Top 10 Most Popular Tracks"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Rank"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Track"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Artist"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Popularity"})]})}),e.jsx("tbody",{children:E.map((s,r)=>e.jsxs("tr",{className:r%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"px-4 py-2",children:r+1}),e.jsx("td",{className:"px-4 py-2",children:s.name}),e.jsx("td",{className:"px-4 py-2",children:s.artist}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-48 bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${s.popularity}%`}})}),e.jsx("span",{className:"ml-2",children:s.popularity})]})})]},r))})]})})]})]})};export{Z as default};

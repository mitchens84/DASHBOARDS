import{r as n,j as e,a4 as y,a5 as b,a6 as g,a7 as c,P as u}from"./vendor-DG7lD9Pa.js";const v=({position:l,color:o,songData:a,setSelected:i})=>e.jsxs("mesh",{position:l,onPointerOver:()=>i(a),onPointerOut:()=>i(null),children:[e.jsx("sphereGeometry",{args:[.01,16,16]}),e.jsx("meshBasicMaterial",{color:o})]}),N=()=>e.jsxs("group",{children:[e.jsxs("line",{children:[e.jsx("bufferGeometry",{children:e.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([0,0,0,1,0,0]),itemSize:3})}),e.jsx("lineBasicMaterial",{color:"red"})]}),e.jsx(c,{position:[1.1,0,0],fontSize:.05,color:"red",children:"Danceability"}),e.jsxs("line",{children:[e.jsx("bufferGeometry",{children:e.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([0,0,0,0,1,0]),itemSize:3})}),e.jsx("lineBasicMaterial",{color:"green"})]}),e.jsx(c,{position:[0,1.1,0],fontSize:.05,color:"green",children:"Energy"}),e.jsxs("line",{children:[e.jsx("bufferGeometry",{children:e.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([0,0,0,0,0,1]),itemSize:3})}),e.jsx("lineBasicMaterial",{color:"blue"})]}),e.jsx(c,{position:[0,0,1.1],fontSize:.05,color:"blue",children:"Valence"})]}),D=()=>{const[l,o]=n.useState([]),[a,i]=n.useState(null),[h,d]=n.useState(!0);return n.useEffect(()=>{(async()=>{try{const r=await window.fs.readFile("241121-track_audio_features.csv",{encoding:"utf8"}),j=await window.fs.readFile("241121-user_saved_tracks.csv",{encoding:"utf8"}),p=u.parse(r,{header:!0,skipEmptyLines:!0}).data,f=u.parse(j,{header:!0,skipEmptyLines:!0}).data,x={};f.forEach(t=>{x[t["Track ID"]]={name:t.Name,artist:t.Artist,popularity:parseInt(t.Popularity)||0}});const m=p.map(t=>({id:t["Track ID"],danceability:parseFloat(t.Danceability),energy:parseFloat(t.Energy),valence:parseFloat(t.Valence),...x[t["Track ID"]]})).filter(t=>!isNaN(t.danceability)&&!isNaN(t.energy)&&!isNaN(t.valence));o(m),d(!1)}catch(r){console.error("Error loading data:",r),d(!1)}})()},[]),h?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl",children:"Loading..."})}):e.jsxs("div",{className:"w-full h-screen relative",children:[e.jsxs(y,{camera:{position:[1.5,1.5,1.5]},children:[e.jsx("ambientLight",{}),e.jsx(b,{}),e.jsx(N,{}),l.map((s,r)=>e.jsx(v,{position:[s.danceability,s.energy,s.valence],color:new g(.5+s.danceability*.5,.5+s.energy*.5,.5+s.valence*.5),songData:s,setSelected:i},s.id||r))]}),a&&e.jsxs("div",{className:"absolute top-4 left-4 bg-white p-4 rounded shadow-lg",children:[e.jsx("h3",{className:"font-bold",children:a.name}),e.jsx("p",{className:"text-gray-600",children:a.artist}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["Danceability: ",a.danceability.toFixed(2)]}),e.jsxs("p",{children:["Energy: ",a.energy.toFixed(2)]}),e.jsxs("p",{children:["Valence: ",a.valence.toFixed(2)]}),e.jsxs("p",{children:["Popularity: ",a.popularity]})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-white p-4 rounded shadow-lg",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Controls:"}),e.jsxs("ul",{className:"text-sm",children:[e.jsx("li",{children:"• Left click + drag to rotate"}),e.jsx("li",{children:"• Right click + drag to pan"}),e.jsx("li",{children:"• Scroll to zoom"}),e.jsx("li",{children:"• Hover over points to see song details"})]})]})]})};export{D as default};
